<!DOCTYPE html><html><head><title>parser.coffee</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../index.html" class="source"><span class="file_name">README</span></a><a href="../lib/cluster.coffee.html" class="source "><span class="base_path">lib / </span><span class="file_name">cluster.coffee</span></a><a href="../lib/encoder.coffee.html" class="source "><span class="base_path">lib / </span><span class="file_name">encoder.coffee</span></a><a href="../lib/navigation.coffee.html" class="source "><span class="base_path">lib / </span><span class="file_name">navigation.coffee</span></a><a href="../lib/navigation/Collect.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">Collect.coffee</span></a><a href="../lib/navigation/FillForm.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">FillForm.coffee</span></a><a href="../lib/navigation/FollowLink.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">FollowLink.coffee</span></a><a href="../lib/navigation/Generic.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">Generic.coffee</span></a><a href="../lib/navigation/Magic.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">Magic.coffee</span></a><a href="../lib/navigation/Pager.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">Pager.coffee</span></a><a href="../lib/navigation/Start.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">Start.coffee</span></a><a href="../lib/navigation/WalkthroughItems.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">WalkthroughItems.coffee</span></a><a href="../lib/navigation/WalkthroughLinks.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">WalkthroughLinks.coffee</span></a><a href="../lib/navigation/helpers.coffee.html" class="source "><span class="base_path">lib / navigation / </span><span class="file_name">helpers.coffee</span></a><a href="../lib/parser.coffee.html" class="source selected"><span class="base_path">lib / </span><span class="file_name">parser.coffee</span></a><a href="../lib/worker.coffee.html" class="source "><span class="base_path">lib / </span><span class="file_name">worker.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>parser.coffee</h1><div class="filepath">lib/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><p>Parser for the specified language of the form fill parameters</p>
</td><td class="code"><div class="highlight"><pre><span class="nv">moment = </span><span class="nx">require</span> <span class="s">&#39;moment&#39;</span>
<span class="nv">jison = </span><span class="nx">require</span> <span class="s">&#39;jison&#39;</span>
<span class="nv">Parser = </span><span class="nx">jison</span><span class="p">.</span><span class="nx">Parser</span>
<span class="nv">cs = </span><span class="nx">require</span> <span class="s">&#39;coffee-script&#39;</span>
<span class="nv">vm = </span><span class="nx">require</span> <span class="s">&#39;vm&#39;</span>
<span class="nv">fs = </span><span class="nx">require</span> <span class="s">&#39;fs&#39;</span>
<span class="nv">assert = </span><span class="nx">require</span> <span class="s">&#39;assert&#39;</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><h3>grammar</h3>

<p>Grammar for the parser</p>
</td><td class="code"><div class="highlight"><pre><span class="nv">grammar = </span><span class="p">{</span>
    <span class="s">&quot;lex&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s">&quot;rules&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">&quot;\\s+&quot;</span><span class="p">,</span>                         <span class="s">&quot;return &#39;SPACE&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;now&quot;</span><span class="p">,</span>                          <span class="s">&quot;return &#39;NOW&#39;;&quot;</span><span class="p">],</span>        
        <span class="p">[</span><span class="s">&quot;\#\{&quot;</span><span class="p">,</span>                         <span class="s">&quot;return &#39;START&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;\}&quot;</span><span class="p">,</span>                           <span class="s">&quot;return &#39;END&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;[0-9]{1,2}\\.[0-9]{1,2}\\.[0-9]{4}&quot;</span><span class="p">,</span> <span class="s">&quot;return &#39;DATE&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;[0-9]+(?:\\.[0-9]+)?\\b&quot;</span><span class="p">,</span>      <span class="s">&quot;return &#39;NUMBER&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;i&quot;</span><span class="p">,</span>                            <span class="s">&quot;return &#39;ITERATOR&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;[A-Za-z_]+[A-Za-z0-9_]*&quot;</span><span class="p">,</span>      <span class="s">&quot;return &#39;VARIABLE&#39;;&quot;</span><span class="p">],</span> <span class="c1"># TODO: exclude js keywords</span>
        <span class="p">[</span><span class="s">&quot;\\*&quot;</span><span class="p">,</span>                          <span class="s">&quot;return &#39;*&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;\\/&quot;</span><span class="p">,</span>                          <span class="s">&quot;return &#39;/&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;-&quot;</span><span class="p">,</span>                            <span class="s">&quot;return &#39;-&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;\\+&quot;</span><span class="p">,</span>                          <span class="s">&quot;return &#39;+&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;\\^&quot;</span><span class="p">,</span>                          <span class="s">&quot;return &#39;^&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;\\(&quot;</span><span class="p">,</span>                          <span class="s">&quot;return &#39;(&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;\\)&quot;</span><span class="p">,</span>                          <span class="s">&quot;return &#39;)&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;$&quot;</span><span class="p">,</span>                            <span class="s">&quot;return &#39;EOF&#39;;&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s">&quot;[A-Za-z0-9_äüöÄÜÖß\\\!\&quot;\§\$\%\&amp;\/\(\)\=\?\`\,\;\.\:\-\^\°\/\*\-\+\{\}]*&quot;</span><span class="p">,</span>          <span class="s">&quot;return &#39;TEXT&#39;;&quot;</span><span class="p">]</span>
        <span class="p">]</span>
    <span class="p">},</span>

    <span class="s">&quot;operators&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">[</span><span class="s">&quot;left&quot;</span><span class="p">,</span> <span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">],</span>
      <span class="p">[</span><span class="s">&quot;left&quot;</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">],</span>
      <span class="p">[</span><span class="s">&quot;left&quot;</span><span class="p">,</span> <span class="s">&quot;^&quot;</span><span class="p">],</span>
      <span class="p">[</span><span class="s">&quot;left&quot;</span><span class="p">,</span> <span class="s">&quot;UMINUS&quot;</span><span class="p">]</span>
    <span class="p">],</span>

    <span class="s">&quot;bnf&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s">&quot;expressions&quot;</span> <span class="o">:</span><span class="p">[[</span> <span class="s">&quot;u EOF&quot;</span><span class="p">,</span>   <span class="s">&quot;return $1;&quot;</span>  <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;EOF&quot;</span><span class="p">,</span>   <span class="s">&quot;return $1;&quot;</span>  <span class="p">]],</span>

      <span class="s">&quot;u&quot;</span> <span class="o">:</span><span class="p">[[</span> <span class="s">&quot;var&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;TEXT&quot;</span><span class="p">,</span>                <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE&quot;</span><span class="p">,</span>                <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;VARIABLE&quot;</span><span class="p">,</span>            <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;DATE&quot;</span><span class="p">,</span>                <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;+&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;-&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;*&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;/&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;^&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;(&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;)&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;ITERATOR&quot;</span><span class="p">,</span>            <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NOW&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NUMBER&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;var u&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;TEXT u&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE u&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;VARIABLE u&quot;</span><span class="p">,</span>          <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;DATE u&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;+ u&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;- u&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;* u&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;/ u&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;^ u&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;( u&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;) u&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;ITERATOR u&quot;</span><span class="p">,</span>          <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NOW u&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NUMBER u&quot;</span><span class="p">,</span>            <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">]</span>
        <span class="p">],</span>
      
      <span class="s">&quot;date&quot;</span> <span class="o">:</span> <span class="p">[[</span> <span class="s">&quot;DATE&quot;</span><span class="p">,</span>          <span class="s">&quot;$$ = \&quot;moment(&#39;\&quot; + $1 + \&quot;&#39;, &#39;D.M.YYYY&#39;).format(format)\&quot;;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;DATE s + e&quot;</span><span class="p">,</span>            <span class="s">&quot;$$ = \&quot;moment(&#39;\&quot; + $1 + \&quot;&#39;, &#39;D.M.YYYY&#39;).add(&#39;d&#39;, \&quot; + $4 + \&quot;).format(format)\&quot;;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;DATE s - e&quot;</span><span class="p">,</span>            <span class="s">&quot;$$ = \&quot;moment(&#39;\&quot; + $1 + \&quot;&#39;, &#39;D.M.YYYY&#39;).subtract(&#39;d&#39;, \&quot; + $4 + \&quot;).format(format)\&quot;;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NOW&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = \&quot;moment().format(format)\&quot;;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NOW s + e&quot;</span><span class="p">,</span>             <span class="s">&quot;$$ = \&quot;moment().add(&#39;d&#39;, \&quot; + $4 + \&quot;).format(format)\&quot;;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NOW s - e&quot;</span><span class="p">,</span>             <span class="s">&quot;$$ = \&quot;moment().subtract(&#39;d&#39;, \&quot; + $4 + \&quot;).format(format)\&quot;;&quot;</span> <span class="p">]],</span>
      
      <span class="s">&quot;var&quot;</span> <span class="o">:</span> <span class="p">[[</span> <span class="s">&quot;START e END&quot;</span><span class="p">,</span>    <span class="s">&quot;$$ = $1 + $2 + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;START date END&quot;</span><span class="p">,</span>      <span class="s">&quot;$$ = $1 + $2 + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;START VARIABLE END&quot;</span><span class="p">,</span>  <span class="s">&quot;$$ = $1 + $2 + $3;&quot;</span> <span class="p">]],</span>

      <span class="s">&quot;e&quot;</span> <span class="o">:</span><span class="p">[</span>
        <span class="p">[</span> <span class="s">&quot;e + e&quot;</span><span class="p">,</span>             <span class="s">&quot;$$ = $1 + \&quot;+\&quot; + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;e - e&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = $1 + \&quot;-\&quot; + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;e * e&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = $1 + \&quot;*\&quot; + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;e / e&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = $1 + \&quot;/\&quot; + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;e ^ e&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = \&quot;Math.pow(\&quot; + $1 + \&quot;,\&quot; + $3 + \&quot;)\&quot;;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;- e&quot;</span><span class="p">,</span>                 <span class="s">&quot;$$ = \&quot;-\&quot; + $2 + $3;&quot;</span><span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;braces&quot;</span><span class="p">,</span>               <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;numbers&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">]],</span>

      <span class="s">&quot;numbers&quot;</span> <span class="o">:</span> <span class="p">[</span>
        <span class="p">[</span> <span class="s">&quot;NUMBER SPACE&quot;</span><span class="p">,</span>        <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;ITERATOR SPACE&quot;</span><span class="p">,</span>      <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE NUMBER&quot;</span><span class="p">,</span>        <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE ITERATOR&quot;</span><span class="p">,</span>      <span class="s">&quot;$$ = $1 + $2;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE NUMBER SPACE&quot;</span><span class="p">,</span>  <span class="s">&quot;$$ = $1 + $2 + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE ITERATOR SPACE&quot;</span><span class="p">,</span><span class="s">&quot;$$ = $1 + $2 + $3;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;NUMBER&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;ITERATOR&quot;</span><span class="p">,</span>            <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">]],</span>
        
      <span class="s">&quot;braces&quot;</span> <span class="o">:</span> <span class="p">[</span>
        <span class="p">[</span> <span class="s">&quot;( e ) SPACE&quot;</span><span class="p">,</span>        <span class="s">&quot;$$ = $1 + $2 + $3 + $4;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE ( e )&quot;</span><span class="p">,</span>        <span class="s">&quot;$$ = $1 + $2 + $3 + $4;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;SPACE ( e ) SPACE&quot;</span><span class="p">,</span>  <span class="s">&quot;$$ = $1 + $2 + $3 + $4 + $5;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;( e )&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1 + $2 + $3;&quot;</span> <span class="p">]],</span>
      
      <span class="s">&quot;s&quot;</span> <span class="o">:</span> <span class="p">[</span>
        <span class="p">[</span> <span class="s">&quot;SPACE&quot;</span><span class="p">,</span>              <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">],</span>
        <span class="p">[</span> <span class="s">&quot;&quot;</span><span class="p">,</span>                   <span class="s">&quot;$$ = $1;&quot;</span> <span class="p">]]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">parser = </span><span class="k">new</span> <span class="nx">Parser</span><span class="p">(</span><span class="nx">grammar</span><span class="p">)</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><h3>parse</h3>

<p>Parses the String from the FillForm Syntax to the end representation</p>

<p>Parameters:</p>

<ul>
<li><strong>string</strong>: the string which should be parsed</li>
<li><strong>vars</strong>: vars is a map of variables which are used for the parsing</li>
</ul>
</td><td class="code"><div class="highlight"><pre><span class="nv">module.exports.parse = parse = </span><span class="nf">(string, vars) -&gt;</span>
  <span class="nv">options = </span><span class="p">{}</span>
  <span class="nv">options.sandbox = </span><span class="nx">vars</span>
  <span class="nv">options.sandbox.moment = </span><span class="nx">require</span> <span class="s">&#39;moment&#39;</span>
  <span class="nv">options.filename = </span><span class="nx">__filename</span>
  <span class="nv">result = </span><span class="nx">cs</span><span class="p">.</span><span class="nb">eval</span> <span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">,</span> <span class="nx">options</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><h3>generate</h3>

<p>Generates a JS Funktion for the parser</p>
</td><td class="code"><div class="highlight"><pre><span class="nv">module.exports.generate = </span><span class="nf">() -&gt;</span>
  <span class="nv">parserSource = </span><span class="nx">parser</span><span class="p">.</span><span class="nx">generate</span><span class="p">()</span>
  <span class="nv">log = </span><span class="nx">fs</span><span class="p">.</span><span class="nx">createWriteStream</span><span class="p">(</span><span class="s">&quot;parser.js&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;flags&#39;</span><span class="o">:</span> <span class="s">&#39;w+&#39;</span><span class="p">});</span>
  <span class="nx">log</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">parserSource</span><span class="p">);</span>
  </pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><h3>test</h3>

<p>Test Funktion</p>
</td><td class="code"><div class="highlight"><pre><span class="nv">module.exports.test = test = </span><span class="nf">() -&gt;</span>
  <span class="nv">i = </span><span class="mi">10</span>
  <span class="nv">format = </span><span class="s">&quot;D.M.YYYY&quot;</span>
  <span class="nv">map = </span><span class="p">{</span> <span class="nv">key1 : </span><span class="s">&quot;String1&quot;</span><span class="p">,</span> <span class="nv">key2 : </span><span class="s">&quot;String2&quot;</span> <span class="p">}</span>
  <span class="nv">vars = </span><span class="nx">map</span>
  <span class="nv">vars.i = </span><span class="nx">i</span>
  <span class="nv">vars.format = </span><span class="nx">format</span>
  </pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>Test only Text input</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;Äquator&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;Äquator&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;München&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;München&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;Test 3TEs fwerergi 15.5&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;Test 3TEs fwerergi 15.5&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;15.01.2012&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;15.01.2012&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;now&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;now&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;1.14&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;1.14&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;i&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;i&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;Test_12&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;Test_12&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;*&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;/&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;-&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;+&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;^&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;^&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;(&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;)&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;3Test&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;3Test&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;a+i&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;a+i&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;a * i&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;a * i&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;10.06.1987+i&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;10.06.1987+i&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;10.06.1987 + i&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;10.06.1987 + i&quot;</span>
  </pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>Test only variables</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;10&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i * i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;100&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;20&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i - i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;0&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i / i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;1&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i ^ i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;10000000000&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i * (i + i)\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;200&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i * 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;50&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i + 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;15&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i - 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;5&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i / 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;2&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i ^ 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;100000&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 * (i + 5)\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;75&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 * i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;50&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;15&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 - i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;-5&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 / i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;0.5&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 ^ i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;9765625&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i * (5 + i)\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;150&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;5&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5.5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;5.5&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 * 6\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;30&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 + 2\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;7&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 - 3\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;2&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 / 2\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;2.5&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 ^ 2\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;25&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{5 * (2 + 4)\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;30&quot;</span>
  </pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>Test Date variables</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{now\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{now + 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{now - 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{now + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{now - i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{now + i + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{now - i + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">().</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="k">try</span>
    <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i + now\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">)</span>
  <span class="k">catch</span> <span class="nx">error</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;now must come at first: OK&quot;</span>
    
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{15.01.2011\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;15.01.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{15.01.2011 + 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;15.01.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{15.01.2011 - 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;15.01.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{15.01.2011 + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;15.01.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{15.01.2011 - i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;15.01.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{15.01.2011 + i + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;15.01.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{15.01.2011 - i + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;15.01.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{1.1.2011\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;1.1.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{1.1.2011 + 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;1.1.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{1.1.2011 - 5\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;1.1.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{1.1.2011 + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;1.1.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{1.1.2011 - i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;1.1.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{1.1.2011 + i + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;1.1.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{1.1.2011 - i + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="nx">moment</span><span class="p">(</span><span class="s">&quot;1.1.2011&quot;</span><span class="p">,</span> <span class="s">&quot;D.M.YYYY&quot;</span><span class="p">).</span><span class="nx">subtract</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">i</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="nx">format</span><span class="p">)</span>
  
  <span class="k">try</span>
    <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{i + 15.01.2011\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">)</span>
  <span class="k">catch</span> <span class="nx">error</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;Date must come at first: OK&quot;</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>Test Mapping</p>
</td><td class="code"><div class="highlight"><pre>  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{key1\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;String1&quot;</span>
  <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span> <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{key2\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">),</span> <span class="s">&quot;String2&quot;</span>
  <span class="k">try</span>
    <span class="nx">parse</span><span class="p">(</span><span class="s">&quot;\#\{key2 + i\}&quot;</span><span class="p">,</span> <span class="nx">vars</span><span class="p">)</span>
  <span class="k">catch</span> <span class="nx">error</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&quot;Only a mapping var in \#\{ \} allowed: OK&quot;</span>
  

</pre></div></td></tr></tbody></table><div id="generated">generated Sun Apr 22 2012 13:41:46 GMT+0200 (CEST)  </div><div id="projectname"><a href="../index.html">Arcane Academy Cluster</a></div></div></body></html>